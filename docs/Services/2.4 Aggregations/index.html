<!doctype html>
<html lang="en" dir="ltr" class="docs-wrapper docs-doc-page docs-version-current plugin-docs plugin-id-default docs-doc-id-Services/2.4 Aggregations/2.4 Aggregations">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width,initial-scale=1">
<meta name="generator" content="Docusaurus v2.0.0-rc.1">
<link rel="alternate" type="application/rss+xml" href="/The-Standard/blog/rss.xml" title="The Standard ❤️ RSS Feed">
<link rel="alternate" type="application/atom+xml" href="/The-Standard/blog/atom.xml" title="The Standard ❤️ Atom Feed"><title data-rh="true">2.4 Aggregation Services (The Knot) | The Standard ❤️</title><meta data-rh="true" name="twitter:card" content="summary_large_image"><meta data-rh="true" property="og:url" content="https://francofgp.github.io/The-Standard/docs/Services/2.4 Aggregations/"><meta data-rh="true" name="docusaurus_locale" content="en"><meta data-rh="true" name="docsearch:language" content="en"><meta data-rh="true" name="docusaurus_version" content="current"><meta data-rh="true" name="docusaurus_tag" content="docs-default-current"><meta data-rh="true" name="docsearch:version" content="current"><meta data-rh="true" name="docsearch:docusaurus_tag" content="docs-default-current"><meta data-rh="true" property="og:title" content="2.4 Aggregation Services (The Knot) | The Standard ❤️"><meta data-rh="true" name="description" content="2.4.0 Introduction"><meta data-rh="true" property="og:description" content="2.4.0 Introduction"><link data-rh="true" rel="icon" href="/The-Standard/img/favicon.ico"><link data-rh="true" rel="canonical" href="https://francofgp.github.io/The-Standard/docs/Services/2.4 Aggregations/"><link data-rh="true" rel="alternate" href="https://francofgp.github.io/The-Standard/docs/Services/2.4 Aggregations/" hreflang="en"><link data-rh="true" rel="alternate" href="https://francofgp.github.io/The-Standard/docs/Services/2.4 Aggregations/" hreflang="x-default"><link rel="stylesheet" href="/The-Standard/assets/css/styles.95b304a2.css">
<link rel="preload" href="/The-Standard/assets/js/runtime~main.06584d35.js" as="script">
<link rel="preload" href="/The-Standard/assets/js/main.1bcd0719.js" as="script">
</head>
<body class="navigation-with-keyboard">
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){var t=null;try{t=localStorage.getItem("theme")}catch(t){}return t}();t(null!==e?e:"light")}()</script><div id="__docusaurus">
<div role="region"><a href="#" class="skipToContent_fXgn">Skip to main content</a></div><nav class="navbar navbar--fixed-top"><div class="navbar__inner"><div class="navbar__items"><button aria-label="Navigation bar toggle" class="navbar__toggle clean-btn" type="button" tabindex="0"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="/The-Standard/"><div class="navbar__logo"><img src="/The-Standard/img/logo.svg" alt="My Site Logo" class="themedImage_ToTc themedImage--light_HNdA"><img src="/The-Standard/img/logo.svg" alt="My Site Logo" class="themedImage_ToTc themedImage--dark_i4oU"></div><b class="navbar__title text--truncate">The Standard</b></a><a aria-current="page" class="navbar__item navbar__link navbar__link--active" href="/The-Standard/docs/intro">Docs</a><a class="navbar__item navbar__link" href="/The-Standard/blog">Blog</a></div><div class="navbar__items navbar__items--right"><a href="https://github.com/facebook/docusaurus" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link">GitHub<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a><div class="toggle_vylO colorModeToggle_DEke"><button class="clean-btn toggleButton_gllP toggleButtonDisabled_aARS" type="button" disabled="" title="Switch between dark and light mode (currently light mode)" aria-label="Switch between dark and light mode (currently light mode)"><svg viewBox="0 0 24 24" width="24" height="24" class="lightToggleIcon_pyhR"><path fill="currentColor" d="M12,9c1.65,0,3,1.35,3,3s-1.35,3-3,3s-3-1.35-3-3S10.35,9,12,9 M12,7c-2.76,0-5,2.24-5,5s2.24,5,5,5s5-2.24,5-5 S14.76,7,12,7L12,7z M2,13l2,0c0.55,0,1-0.45,1-1s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S1.45,13,2,13z M20,13l2,0c0.55,0,1-0.45,1-1 s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S19.45,13,20,13z M11,2v2c0,0.55,0.45,1,1,1s1-0.45,1-1V2c0-0.55-0.45-1-1-1S11,1.45,11,2z M11,20v2c0,0.55,0.45,1,1,1s1-0.45,1-1v-2c0-0.55-0.45-1-1-1C11.45,19,11,19.45,11,20z M5.99,4.58c-0.39-0.39-1.03-0.39-1.41,0 c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0s0.39-1.03,0-1.41L5.99,4.58z M18.36,16.95 c-0.39-0.39-1.03-0.39-1.41,0c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0c0.39-0.39,0.39-1.03,0-1.41 L18.36,16.95z M19.42,5.99c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06c-0.39,0.39-0.39,1.03,0,1.41 s1.03,0.39,1.41,0L19.42,5.99z M7.05,18.36c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06 c-0.39,0.39-0.39,1.03,0,1.41s1.03,0.39,1.41,0L7.05,18.36z"></path></svg><svg viewBox="0 0 24 24" width="24" height="24" class="darkToggleIcon_wfgR"><path fill="currentColor" d="M9.37,5.51C9.19,6.15,9.1,6.82,9.1,7.5c0,4.08,3.32,7.4,7.4,7.4c0.68,0,1.35-0.09,1.99-0.27C17.45,17.19,14.93,19,12,19 c-3.86,0-7-3.14-7-7C5,9.07,6.81,6.55,9.37,5.51z M12,3c-4.97,0-9,4.03-9,9s4.03,9,9,9s9-4.03,9-9c0-0.46-0.04-0.92-0.1-1.36 c-0.98,1.37-2.58,2.26-4.4,2.26c-2.98,0-5.4-2.42-5.4-5.4c0-1.81,0.89-3.42,2.26-4.4C12.92,3.04,12.46,3,12,3L12,3z"></path></svg></button></div><div class="searchBox_ZlJk"></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div class="main-wrapper mainWrapper_z2l0 docsWrapper_BCFX"><button aria-label="Scroll back to top" class="clean-btn theme-back-to-top-button backToTopButton_sjWU" type="button"></button><div class="docPage__5DB"><aside class="theme-doc-sidebar-container docSidebarContainer_b6E3"><div class="sidebar_njMd"><nav class="menu thin-scrollbar menu_SIkG"><ul class="theme-doc-sidebar-menu menu__list"><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" href="/The-Standard/docs/Introduction/">0 Introduction</a><button aria-label="Toggle the collapsible sidebar category &#x27;0 Introduction&#x27;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/The-Standard/docs/Brokers/">1 Brokers</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--active" aria-expanded="true" href="/The-Standard/docs/Services/">2 Services</a><button aria-label="Toggle the collapsible sidebar category &#x27;2 Services&#x27;" type="button" class="clean-btn menu__caret"></button></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/The-Standard/docs/Services/2.1 Foundations/">2.1 Foundation Services (Broker-Neighboring)</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/The-Standard/docs/Services/2.2 Processings/">2.2 Processing Services (Higher-Order Business Logic)</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/The-Standard/docs/Services/2.3 Orchestrations/">2.3 Orchestration Services (Complex Higher Order Logic)</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link menu__link--active" aria-current="page" tabindex="0" href="/The-Standard/docs/Services/2.4 Aggregations/">2.4 Aggregation Services (The Knot)</a></li></ul></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" href="/The-Standard/docs/Exposers/">3 Exposers</a><button aria-label="Toggle the collapsible sidebar category &#x27;3 Exposers&#x27;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/The-Standard/docs/intro">The Standard (v 2.0.1)</a></li></ul></nav></div></aside><main class="docMainContainer_gTbr"><div class="container padding-top--md padding-bottom--lg"><div class="row"><div class="col docItemCol_VOVn"><div class="docItemContainer_Djhp"><article><nav class="theme-doc-breadcrumbs breadcrumbsContainer_Z_bl" aria-label="Breadcrumbs"><ul class="breadcrumbs" itemscope="" itemtype="https://schema.org/BreadcrumbList"><li class="breadcrumbs__item"><a aria-label="Home page" class="breadcrumbs__link" href="/The-Standard/"><svg viewBox="0 0 24 24" class="breadcrumbHomeIcon_OVgt"><path d="M10 19v-5h4v5c0 .55.45 1 1 1h3c.55 0 1-.45 1-1v-7h1.7c.46 0 .68-.57.33-.87L12.67 3.6c-.38-.34-.96-.34-1.34 0l-8.36 7.53c-.34.3-.13.87.33.87H5v7c0 .55.45 1 1 1h3c.55 0 1-.45 1-1z" fill="currentColor"></path></svg></a></li><li itemscope="" itemprop="itemListElement" itemtype="https://schema.org/ListItem" class="breadcrumbs__item"><a class="breadcrumbs__link" itemprop="item" href="/The-Standard/docs/Services/"><span itemprop="name">2 Services</span></a><meta itemprop="position" content="1"></li><li itemscope="" itemprop="itemListElement" itemtype="https://schema.org/ListItem" class="breadcrumbs__item breadcrumbs__item--active"><span class="breadcrumbs__link" itemprop="name">2.4 Aggregation Services (The Knot)</span><meta itemprop="position" content="2"></li></ul></nav><div class="tocCollapsible_ETCw theme-doc-toc-mobile tocMobile_ITEo"><button type="button" class="clean-btn tocCollapsibleButton_TO0P">On this page</button></div><div class="theme-doc-markdown markdown"><h1>2.4 Aggregation Services (The Knot)</h1><h2 class="anchor anchorWithStickyNavbar_LWe7" id="240-introduction">2.4.0 Introduction<a class="hash-link" href="#240-introduction" title="Direct link to heading">​</a></h2><p>Aggregation services main responsibility is to expose one single point of contact between the core business logic layer and any exposure layers. It ensures, if multiple services of any variation share the same contract, that they are aggregated and exposed to one exposer component through one logical layer.</p><p>Aggregation services don&#x27;t hold any business logic in themselves. They are simply a knot that ties together multiple services of any number. They can have any layer of services as dependencies and it mainly exposes the call to these services accordingly. Here&#x27;s a code example of an aggregation service:</p><div class="language-csharp codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-csharp codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">public async ValueTask ProcessStudentAsync(Student student)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">{</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    await this.studentRegistrationCoordinationService.RegisterStudentAsync(student);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    await this.studentRecordsCoordinationService.AddStudentRecordAsync(student);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    ...</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    ...</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    await this.anyOtherStudentRelatedCoordinationService.DoSomethingWithStudentAsync(student);    </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>As the snippet shows above, an Aggregation service may have any number of calls in any order without limitation. And there may be occasions where you may or may not need to return a value to your exposure layers depending on the overall flow and architecture, which we will discuss shortly in this chapter. But more importantly Aggregation services should not be mistaken for an orchestration service or any of its variants.</p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="241-on-the-map">2.4.1 On The Map<a class="hash-link" href="#241-on-the-map" title="Direct link to heading">​</a></h2><p>Aggregation services always sit on the other end of a core business logic layer. They are the last point of contact between exposure layers and logic layers. here&#x27;s a visualization of where aggregation services would be located in an overall architecture:</p><br><p align="center"><img loading="lazy" src="https://user-images.githubusercontent.com/1453985/147583126-c2b73db9-f77f-486f-806a-e9bfe32cec16.png" class="img_ev3q"></p><br><p>Let&#x27;s discuss the characteristics of Aggregation services.</p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="242-characteristics">2.4.2 Characteristics<a class="hash-link" href="#242-characteristics" title="Direct link to heading">​</a></h2><p>Aggregation services mainly exist when there are multiple services, sharing the same contract or sharing primitive types of the same contract, that require a single point of exposure. They mainly exist in hyper-complex applications where multiple services (usually orchestration or higher but can be lower) require one single point of contact through exposure layers. Let&#x27;s talk in detail about the main characteristics for Aggregation services.</p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="2420-no-dependency-limitation">2.4.2.0 No Dependency Limitation<a class="hash-link" href="#2420-no-dependency-limitation" title="Direct link to heading">​</a></h3><p>Unlike any other service, Aggregation services can have any number of dependencies as long as these services are of the same variation. For instance, an Aggregation service cannot aggregate between an Orchestration service and a Coordination service. It&#x27;s a partial Florance-Like pattern where services have to be of the same variation but not necessary limited by the number.</p><p>The reason for the lack of limitation of the dependencies for Aggregation services is because the service itself doesn&#x27;t perform any level of business logic between these services. It doesn&#x27;t care what these services do or require. It only focuses on exposing these services regardless of what was called before or after them.</p><p>Here&#x27;s what an Aggregation service test would look like:</p><div class="language-csharp codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-csharp codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[Fact]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">public async Task ShouldProcessStudentAsync()</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">{</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    // given</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    Student randomStudent = CreatedRandomStudent();</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    Student inputStudent = randomStudent;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    // when</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    await this.studentAggregationService.ProcessStudentAsync(inputStudent);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    // then</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    this.studentRegistrationCoordinationServiceMock.Verify(service =&gt;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        service.RegisterStudentAsync(student),</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            Times.Once);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    this.studentRecordsCoordinationServiceMock.Verify(service =&gt;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        service.AddStudentRecordAsync(student),</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            Times.Once);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    ...</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    ...</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    this.anyOtherStudentRelatedCoordinationServiceMock.Verify(service =&gt;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        service.DoSomethingWithStudentAsync(student),</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            Times.Once);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    this.studentRegistrationCoordinationServiceMock.VerifyNoOtherCalls();</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    this.studentRecordsCoordinationServiceMock.VerifyNoOtherCalls();</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    ...</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    ...</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    this.anyOtherStudentRelatedCoordinationServiceMock.VerifyNoOtherCalls();</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>As you can see above, we are only verifying and testing for the aggregation aspect of calling these services. No return type required in this scenario but there might be in the scenarios of pass-through which we will be discussing shortly.</p><p>An implementation of the above test would be as follows:</p><div class="language-csharp codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-csharp codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">public async ValueTask ProcessStudentAsync(Student student)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">{</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    await this.studentRegistrationCoordinationService.RegisterStudentAsync(student);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    await this.studentRecordsCoordinationService.AddStudentRecordAsync(student);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    ...</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    ...</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    await this.anyOtherStudentRelatedCoordinationService.DoSomethingWithStudentAsync(student);    </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h3 class="anchor anchorWithStickyNavbar_LWe7" id="2421-no-order-validation">2.4.2.1 No Order Validation<a class="hash-link" href="#2421-no-order-validation" title="Direct link to heading">​</a></h3><p>By definition, Aggregation services are naturally required to call several dependencies with no limitation. The order of calling these dependencies is also not a concern or a responsibility for Aggregation services. That&#x27;s simply because the call-order verification is considered a core business logic. which falls outside of the responsibilities of an Aggregation service. That of course includes both natural order of verification or enforced order of verification as we explained in section 2.3.3.0.1 in the previous chapter.</p><p>It&#x27;s a violation of The Standard to attempt using simple techniques like a mock sequence in testing an Aggregation service. These responsibilities are more likely to fall on the next lower layer of an Aggregation service for any orchestration-like service. It is also a violation to verify reliance on the return value of one service call to initiate a call to the next.</p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="2422-basic-validations">2.4.2.2 Basic Validations<a class="hash-link" href="#2422-basic-validations" title="Direct link to heading">​</a></h3><p>Aggregation services are still required to validate whether the incoming data is higher-level structurally valid or not. For instance, an Aggregation service that takes a <code>Student</code> object as an input parameter will validate only if the <code>student</code> is <code>null</code> or not. But that&#x27;s where it all stops.</p><p>There may be an occasion where a dependency requires a property of an input parameter to be passed in, in which case it is also permitted to validate that property value structurally. For instance, if a downstream dependency requires a student name to be passed in. An Aggregation service is still going to be required to validate if the <code>Name</code> is <code>null</code>, empty or just whitespace.</p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="2423-pass-through">2.4.2.3 Pass-Through<a class="hash-link" href="#2423-pass-through" title="Direct link to heading">​</a></h3><p>Aggregation services are not also required to implement their aggregation by performing multiple calls from one method. They can also aggregate by offering a pass-through methods for multiple services. For instance, assume we have <code>studentCoordinationService</code> and <code>studentRecordsService</code> and <code>anyOtherStudentRelatedCoordinationService</code> and each one of these services are independent in terms of business flow. So an aggregation here is only at the level of exposure but not necessarily the level of execution.</p><p>Here&#x27;s a code example:</p><div class="language-csharp codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-csharp codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">public partial class StudentAggregationService</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">{</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    ...</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    public async ValueTask&lt;Student&gt; RegisterStudentAsync(Student student)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        ...</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        return await this.studentCoordinationService.RegisterStudentAsync(student);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    public async ValueTask&lt;Student&gt; AddStudentRecordAsync(Student student)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        ...</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        return await this.studentRecordsCoordinationService.AddStudentRecordAsync(student);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    ...</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    ...</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    public async ValueTask&lt;Student&gt; DoSomethingWithStudentAsync(Student student)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        ...</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        return await this.anyOtherStudentRelatedCoordinationService.DoSomethingWithStudentAsync(student);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>As you can see above, each service is using the Aggregation service as a pass-through. There&#x27;s no need in this scenario whatsoever for an aggregated routines call. This would still be a very valid scenario for Aggregation services.</p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="2424-optionality">2.4.2.4 Optionality<a class="hash-link" href="#2424-optionality" title="Direct link to heading">​</a></h3><p>It is important to mention here that Aggregation services are optional. Unlike foundation services, Aggregation services may or may not exist in any architecture. Aggregation services are there to solve a problem with abstraction. This problem may or may not exist based on whether the architecture requires a single point of exposure at the border of the core business logic layer or not. This single responsibility of Aggregation services makes it much simpler to implement its task and perform its function easily. Aggregation services being optional is more likely to be than any other lower-level services. Even in the most complex of applications out there.</p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="2425-routine-level-aggregation">2.4.2.5 Routine-Level Aggregation<a class="hash-link" href="#2425-routine-level-aggregation" title="Direct link to heading">​</a></h3><p>If an aggregation service has to make two different calls from the same dependency amongst other calls, It is recommended to aggregate for every dependency routine. But that&#x27;s only from code-cleanliness perspective and it doesn&#x27;t necessarily impact the architecture or the end-result in any way.</p><p>here&#x27;s an example:</p><div class="language-csharp codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-csharp codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">public async ValueTask ProcessStudent(Student student)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">{</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    await this.studentCoordinationService.AddStudentAsync(student);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    await ProcessStudentRecordAsync(student);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">private async ValueTask ProcessStudentRecordAsync(Student student)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">{</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    await this.studentRecordCoordinationService.AddStudentRecordAsync(student);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    await this.studentRecordCoordinationService.NotifyStudentRecordAdminsAsync(student);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>This organizational action doesn&#x27;t warrant any kind of change in terms of testing or end-result as previously mentioned.</p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="2426-pure-dependency-contracts">2.4.2.6 Pure Dependency Contracts<a class="hash-link" href="#2426-pure-dependency-contracts" title="Direct link to heading">​</a></h3><p>The most important rule/characteristic of an Aggregation service is that its dependencies (unlike orchestration services) must share the same contract. The input parameter for a public routine in any Aggregation service must be the same for all its dependencies. There may be occasions where a dependency may require a student id instead of of the entire student that is permitted with caution as long as the partial contract isn&#x27;t a return type of another call within the same routine.</p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="243-responsibilities">2.4.3 Responsibilities<a class="hash-link" href="#243-responsibilities" title="Direct link to heading">​</a></h2><p>Aggregation services main responsibility is to offer a single point of contact between exposer components and the rest of the core business logic. But in essence, abstraction is the true value Aggregation services offer to ensure any business component as a whole is pluggable into any system regardless of the style of exposure this very system may need.</p><p>Let&#x27;s talk about these responsibilities in detail.</p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="2430-abstraction">2.4.3.0 Abstraction<a class="hash-link" href="#2430-abstraction" title="Direct link to heading">​</a></h3><p>An aggregation service performs into responsibility successfully when its clients or consumers have no idea what lies beyond the lines of its implementation. An Aggregation service could be combining 10 different services and exposes a single routine in a fire-n-forget scenario.</p><p>But even in pass-through scenarios, Aggregation services abstract away any identification of the underlying dependency from exposers at all costs. It doesn&#x27;t always happen especially in terms of localized exceptions but close enough to make the integration seem as if it is with one single service that&#x27;s offering all the options natively.</p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="2431-exceptions-aggregation">2.4.3.1 Exceptions Aggregation<a class="hash-link" href="#2431-exceptions-aggregation" title="Direct link to heading">​</a></h3><p>Aggregation services are also similar to orchestration-like services in terms of mapping and aggregating exceptions from downstream dependencies. For instance, if <code>studentCoordinationService</code> is throwing <code>StudentCoordinationValidationException</code>an Aggregation service would map that into <code>StudentAggregationDependencyValidationException</code>. This falls back into the concept of exception unwrapping then wrapping of localized exceptions which we spoke about in detail in section 2.3.3.0.2 of this Standard.</p></div><footer class="theme-doc-footer docusaurus-mt-lg"><div class="theme-doc-footer-edit-meta-row row"><div class="col"><a href="https://github.com/facebook/docusaurus/tree/main/packages/create-docusaurus/templates/shared/docs/2. Services/2.4 Aggregations/2.4 Aggregations.md" target="_blank" rel="noreferrer noopener" class="theme-edit-this-page"><svg fill="currentColor" height="20" width="20" viewBox="0 0 40 40" class="iconEdit_Z9Sw" aria-hidden="true"><g><path d="m34.5 11.7l-3 3.1-6.3-6.3 3.1-3q0.5-0.5 1.2-0.5t1.1 0.5l3.9 3.9q0.5 0.4 0.5 1.1t-0.5 1.2z m-29.5 17.1l18.4-18.5 6.3 6.3-18.4 18.4h-6.3v-6.2z"></path></g></svg>Edit this page</a></div><div class="col lastUpdated_vwxv"></div></div></footer></article><nav class="pagination-nav docusaurus-mt-lg" aria-label="Docs pages navigation"><a class="pagination-nav__link pagination-nav__link--prev" href="/The-Standard/docs/Services/2.3 Orchestrations/"><div class="pagination-nav__sublabel">Previous</div><div class="pagination-nav__label">2.3 Orchestration Services (Complex Higher Order Logic)</div></a><a class="pagination-nav__link pagination-nav__link--next" href="/The-Standard/docs/Exposers/"><div class="pagination-nav__sublabel">Next</div><div class="pagination-nav__label">3 Exposers</div></a></nav></div></div><div class="col col--3"><div class="tableOfContents_bqdL thin-scrollbar theme-doc-toc-desktop"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#240-introduction" class="table-of-contents__link toc-highlight">2.4.0 Introduction</a></li><li><a href="#241-on-the-map" class="table-of-contents__link toc-highlight">2.4.1 On The Map</a></li><li><a href="#242-characteristics" class="table-of-contents__link toc-highlight">2.4.2 Characteristics</a><ul><li><a href="#2420-no-dependency-limitation" class="table-of-contents__link toc-highlight">2.4.2.0 No Dependency Limitation</a></li><li><a href="#2421-no-order-validation" class="table-of-contents__link toc-highlight">2.4.2.1 No Order Validation</a></li><li><a href="#2422-basic-validations" class="table-of-contents__link toc-highlight">2.4.2.2 Basic Validations</a></li><li><a href="#2423-pass-through" class="table-of-contents__link toc-highlight">2.4.2.3 Pass-Through</a></li><li><a href="#2424-optionality" class="table-of-contents__link toc-highlight">2.4.2.4 Optionality</a></li><li><a href="#2425-routine-level-aggregation" class="table-of-contents__link toc-highlight">2.4.2.5 Routine-Level Aggregation</a></li><li><a href="#2426-pure-dependency-contracts" class="table-of-contents__link toc-highlight">2.4.2.6 Pure Dependency Contracts</a></li></ul></li><li><a href="#243-responsibilities" class="table-of-contents__link toc-highlight">2.4.3 Responsibilities</a><ul><li><a href="#2430-abstraction" class="table-of-contents__link toc-highlight">2.4.3.0 Abstraction</a></li><li><a href="#2431-exceptions-aggregation" class="table-of-contents__link toc-highlight">2.4.3.1 Exceptions Aggregation</a></li></ul></li></ul></div></div></div></div></main></div></div><footer class="footer footer--dark"><div class="container container-fluid"><div class="row footer__links"><div class="col footer__col"><div class="footer__title">Docs</div><ul class="footer__items clean-list"><li class="footer__item"><a class="footer__link-item" href="/The-Standard/docs/intro">Tutorial</a></li></ul></div><div class="col footer__col"><div class="footer__title">Community</div><ul class="footer__items clean-list"><li class="footer__item"><a href="https://stackoverflow.com/questions/tagged/docusaurus" target="_blank" rel="noopener noreferrer" class="footer__link-item">Stack Overflow<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li><li class="footer__item"><a href="https://discordapp.com/invite/docusaurus" target="_blank" rel="noopener noreferrer" class="footer__link-item">Discord<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li><li class="footer__item"><a href="https://twitter.com/docusaurus" target="_blank" rel="noopener noreferrer" class="footer__link-item">Twitter<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li></ul></div><div class="col footer__col"><div class="footer__title">More</div><ul class="footer__items clean-list"><li class="footer__item"><a class="footer__link-item" href="/The-Standard/blog">Blog</a></li><li class="footer__item"><a href="https://github.com/facebook/docusaurus" target="_blank" rel="noopener noreferrer" class="footer__link-item">GitHub<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li></ul></div></div><div class="footer__bottom text--center"><div class="footer__copyright">Copyright © 2022 My Project, Inc. Built with Docusaurus.</div></div></div></footer></div>
<script src="/The-Standard/assets/js/runtime~main.06584d35.js"></script>
<script src="/The-Standard/assets/js/main.1bcd0719.js"></script>
</body>
</html>