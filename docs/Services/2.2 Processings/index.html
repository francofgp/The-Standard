<!doctype html>
<html lang="en" dir="ltr" class="docs-wrapper docs-doc-page docs-version-current plugin-docs plugin-id-default docs-doc-id-Services/2.2 Processings/2.2 Processings">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width,initial-scale=1">
<meta name="generator" content="Docusaurus v2.0.0-rc.1">
<link rel="alternate" type="application/rss+xml" href="/The-Standard/blog/rss.xml" title="The Standard ❤️ RSS Feed">
<link rel="alternate" type="application/atom+xml" href="/The-Standard/blog/atom.xml" title="The Standard ❤️ Atom Feed"><title data-rh="true">2.2 Processing Services (Higher-Order Business Logic) | The Standard ❤️</title><meta data-rh="true" name="twitter:card" content="summary_large_image"><meta data-rh="true" property="og:url" content="https://francofgp.github.io/The-Standard/docs/Services/2.2 Processings/"><meta data-rh="true" name="docusaurus_locale" content="en"><meta data-rh="true" name="docsearch:language" content="en"><meta data-rh="true" name="docusaurus_version" content="current"><meta data-rh="true" name="docusaurus_tag" content="docs-default-current"><meta data-rh="true" name="docsearch:version" content="current"><meta data-rh="true" name="docsearch:docusaurus_tag" content="docs-default-current"><meta data-rh="true" property="og:title" content="2.2 Processing Services (Higher-Order Business Logic) | The Standard ❤️"><meta data-rh="true" name="description" content="2.2.0 Introduction"><meta data-rh="true" property="og:description" content="2.2.0 Introduction"><link data-rh="true" rel="icon" href="/The-Standard/img/favicon.ico"><link data-rh="true" rel="canonical" href="https://francofgp.github.io/The-Standard/docs/Services/2.2 Processings/"><link data-rh="true" rel="alternate" href="https://francofgp.github.io/The-Standard/docs/Services/2.2 Processings/" hreflang="en"><link data-rh="true" rel="alternate" href="https://francofgp.github.io/The-Standard/docs/Services/2.2 Processings/" hreflang="x-default"><link rel="stylesheet" href="/The-Standard/assets/css/styles.95b304a2.css">
<link rel="preload" href="/The-Standard/assets/js/runtime~main.06584d35.js" as="script">
<link rel="preload" href="/The-Standard/assets/js/main.1bcd0719.js" as="script">
</head>
<body class="navigation-with-keyboard">
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){var t=null;try{t=localStorage.getItem("theme")}catch(t){}return t}();t(null!==e?e:"light")}()</script><div id="__docusaurus">
<div role="region"><a href="#" class="skipToContent_fXgn">Skip to main content</a></div><nav class="navbar navbar--fixed-top"><div class="navbar__inner"><div class="navbar__items"><button aria-label="Navigation bar toggle" class="navbar__toggle clean-btn" type="button" tabindex="0"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="/The-Standard/"><div class="navbar__logo"><img src="/The-Standard/img/logo.svg" alt="My Site Logo" class="themedImage_ToTc themedImage--light_HNdA"><img src="/The-Standard/img/logo.svg" alt="My Site Logo" class="themedImage_ToTc themedImage--dark_i4oU"></div><b class="navbar__title text--truncate">The Standard</b></a><a aria-current="page" class="navbar__item navbar__link navbar__link--active" href="/The-Standard/docs/intro">Docs</a><a class="navbar__item navbar__link" href="/The-Standard/blog">Blog</a></div><div class="navbar__items navbar__items--right"><a href="https://github.com/facebook/docusaurus" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link">GitHub<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a><div class="toggle_vylO colorModeToggle_DEke"><button class="clean-btn toggleButton_gllP toggleButtonDisabled_aARS" type="button" disabled="" title="Switch between dark and light mode (currently light mode)" aria-label="Switch between dark and light mode (currently light mode)"><svg viewBox="0 0 24 24" width="24" height="24" class="lightToggleIcon_pyhR"><path fill="currentColor" d="M12,9c1.65,0,3,1.35,3,3s-1.35,3-3,3s-3-1.35-3-3S10.35,9,12,9 M12,7c-2.76,0-5,2.24-5,5s2.24,5,5,5s5-2.24,5-5 S14.76,7,12,7L12,7z M2,13l2,0c0.55,0,1-0.45,1-1s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S1.45,13,2,13z M20,13l2,0c0.55,0,1-0.45,1-1 s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S19.45,13,20,13z M11,2v2c0,0.55,0.45,1,1,1s1-0.45,1-1V2c0-0.55-0.45-1-1-1S11,1.45,11,2z M11,20v2c0,0.55,0.45,1,1,1s1-0.45,1-1v-2c0-0.55-0.45-1-1-1C11.45,19,11,19.45,11,20z M5.99,4.58c-0.39-0.39-1.03-0.39-1.41,0 c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0s0.39-1.03,0-1.41L5.99,4.58z M18.36,16.95 c-0.39-0.39-1.03-0.39-1.41,0c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0c0.39-0.39,0.39-1.03,0-1.41 L18.36,16.95z M19.42,5.99c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06c-0.39,0.39-0.39,1.03,0,1.41 s1.03,0.39,1.41,0L19.42,5.99z M7.05,18.36c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06 c-0.39,0.39-0.39,1.03,0,1.41s1.03,0.39,1.41,0L7.05,18.36z"></path></svg><svg viewBox="0 0 24 24" width="24" height="24" class="darkToggleIcon_wfgR"><path fill="currentColor" d="M9.37,5.51C9.19,6.15,9.1,6.82,9.1,7.5c0,4.08,3.32,7.4,7.4,7.4c0.68,0,1.35-0.09,1.99-0.27C17.45,17.19,14.93,19,12,19 c-3.86,0-7-3.14-7-7C5,9.07,6.81,6.55,9.37,5.51z M12,3c-4.97,0-9,4.03-9,9s4.03,9,9,9s9-4.03,9-9c0-0.46-0.04-0.92-0.1-1.36 c-0.98,1.37-2.58,2.26-4.4,2.26c-2.98,0-5.4-2.42-5.4-5.4c0-1.81,0.89-3.42,2.26-4.4C12.92,3.04,12.46,3,12,3L12,3z"></path></svg></button></div><div class="searchBox_ZlJk"></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div class="main-wrapper mainWrapper_z2l0 docsWrapper_BCFX"><button aria-label="Scroll back to top" class="clean-btn theme-back-to-top-button backToTopButton_sjWU" type="button"></button><div class="docPage__5DB"><aside class="theme-doc-sidebar-container docSidebarContainer_b6E3"><div class="sidebar_njMd"><nav class="menu thin-scrollbar menu_SIkG"><ul class="theme-doc-sidebar-menu menu__list"><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" href="/The-Standard/docs/Introduction/">0 Introduction</a><button aria-label="Toggle the collapsible sidebar category &#x27;0 Introduction&#x27;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/The-Standard/docs/Brokers/">1 Brokers</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--active" aria-expanded="true" href="/The-Standard/docs/Services/">2 Services</a><button aria-label="Toggle the collapsible sidebar category &#x27;2 Services&#x27;" type="button" class="clean-btn menu__caret"></button></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/The-Standard/docs/Services/2.1 Foundations/">2.1 Foundation Services (Broker-Neighboring)</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link menu__link--active" aria-current="page" tabindex="0" href="/The-Standard/docs/Services/2.2 Processings/">2.2 Processing Services (Higher-Order Business Logic)</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/The-Standard/docs/Services/2.3 Orchestrations/">2.3 Orchestration Services (Complex Higher Order Logic)</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/The-Standard/docs/Services/2.4 Aggregations/">2.4 Aggregation Services (The Knot)</a></li></ul></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" href="/The-Standard/docs/Exposers/">3 Exposers</a><button aria-label="Toggle the collapsible sidebar category &#x27;3 Exposers&#x27;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/The-Standard/docs/intro">The Standard (v 2.0.1)</a></li></ul></nav></div></aside><main class="docMainContainer_gTbr"><div class="container padding-top--md padding-bottom--lg"><div class="row"><div class="col docItemCol_VOVn"><div class="docItemContainer_Djhp"><article><nav class="theme-doc-breadcrumbs breadcrumbsContainer_Z_bl" aria-label="Breadcrumbs"><ul class="breadcrumbs" itemscope="" itemtype="https://schema.org/BreadcrumbList"><li class="breadcrumbs__item"><a aria-label="Home page" class="breadcrumbs__link" href="/The-Standard/"><svg viewBox="0 0 24 24" class="breadcrumbHomeIcon_OVgt"><path d="M10 19v-5h4v5c0 .55.45 1 1 1h3c.55 0 1-.45 1-1v-7h1.7c.46 0 .68-.57.33-.87L12.67 3.6c-.38-.34-.96-.34-1.34 0l-8.36 7.53c-.34.3-.13.87.33.87H5v7c0 .55.45 1 1 1h3c.55 0 1-.45 1-1z" fill="currentColor"></path></svg></a></li><li itemscope="" itemprop="itemListElement" itemtype="https://schema.org/ListItem" class="breadcrumbs__item"><a class="breadcrumbs__link" itemprop="item" href="/The-Standard/docs/Services/"><span itemprop="name">2 Services</span></a><meta itemprop="position" content="1"></li><li itemscope="" itemprop="itemListElement" itemtype="https://schema.org/ListItem" class="breadcrumbs__item breadcrumbs__item--active"><span class="breadcrumbs__link" itemprop="name">2.2 Processing Services (Higher-Order Business Logic)</span><meta itemprop="position" content="2"></li></ul></nav><div class="tocCollapsible_ETCw theme-doc-toc-mobile tocMobile_ITEo"><button type="button" class="clean-btn tocCollapsibleButton_TO0P">On this page</button></div><div class="theme-doc-markdown markdown"><h1>2.2 Processing Services (Higher-Order Business Logic)</h1><h2 class="anchor anchorWithStickyNavbar_LWe7" id="220-introduction">2.2.0 Introduction<a class="hash-link" href="#220-introduction" title="Direct link to heading">​</a></h2><p>Processing services are the layer where a higher order of business logic is implemented. They may combine (or orchestrate) two primitive-level functions from their corresponding foundation service to introduce a newer functionality. They may also call one primitive function and change the outcome with a little bit of added business logic. And sometimes processing services are there as a pass-through to introduce balance to the overall architecture.</p><p>Processing services are optional, depending on your business need - in a simple CRUD operations API, processing services and all the other categories of services beyond that point will cease to exist as there is no need for a higher order of business logic at that point.</p><p>Here&#x27;s an example of what a Processing service function would look like:</p><div class="language-csharp codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-csharp codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">public ValueTask&lt;Student&gt; UpsertStudentAsync(Student student) =&gt;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">TryCatch(async () =&gt;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">{</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    ValidateStudent(student);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    IQueryable&lt;Student&gt; allStudents =</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        this.studentService.RetrieveAllStudents();</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    bool studentExists = allStudents.Any(retrievedStudent =&gt;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        retrievedStudent.Id == student.Id);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    return studentExists switch {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        false =&gt; await this.studentService.RegisterStudentAsync(student),</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        _ =&gt; await this.studentService.ModifyStudentAsync(student.Id)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    };</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">});</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>Processing services make Foundation services nothing but a layer of validation on top of the existing primitive operations. Which means that Processing services functions are beyond primitive, and they only deal with local models as we will discuss in the upcoming sections.</p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="221-on-the-map">2.2.1 On The Map<a class="hash-link" href="#221-on-the-map" title="Direct link to heading">​</a></h2><p>When used, Processing services live between foundation services and the rest of the application. they may not call Entity or Business brokers, but they may call Utility brokers such as logging brokers, time brokers and any other brokers that offer supporting functionality and not specific to any particular business logic. Here&#x27;s a visual of where processing services are located on the map of our architecture:</p><br><p align="center"><img loading="lazy" src="https://user-images.githubusercontent.com/1453985/111928442-d9cd1b00-8a70-11eb-82c8-83399c98c87d.png" class="img_ev3q"></p><br><p>On the right side of a Processing service lies all the non-local models and functionality, whether it&#x27;s through the brokers, or the models that the foundation service is trying to map into local models.
On the left side of Processing services is pure local functionality, models and architecture. Starting from the Processing services themselves, there should be no trace or track of any native or non-local models in the system.</p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="222-charachteristics">2.2.2 Charachteristics<a class="hash-link" href="#222-charachteristics" title="Direct link to heading">​</a></h2><p>Processing services in general are combiners of multiple primitive-level functions to produce a higher-order business logic. but they have much more characteristics than just that, let&#x27;s talk about those here.</p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="2220-language">2.2.2.0 Language<a class="hash-link" href="#2220-language" title="Direct link to heading">​</a></h3><p>The language used in processing services defines the level of complexity and the capabilities it offers.
Usually, processing services combine two or more primitive operations from the foundation layer to create a new value.</p><h4 class="anchor anchorWithStickyNavbar_LWe7" id="22200-functions-language">2.2.2.0.0 Functions Language<a class="hash-link" href="#22200-functions-language" title="Direct link to heading">​</a></h4><p>At a glance, Processing services language change from primitive operations such as <code>AddStudent</code> or <code>RemoveStudent</code> to <code>EnsureStudentExists</code> or <code>UpsertStudent</code>. they usually offer a more advanced business-logic operations to support a higher order functionality.
Here&#x27;s some examples for the most common combinations a processing service may offer:</p><table><thead><tr><th>Processing Operation</th><th>Primitive Functions</th></tr></thead><tbody><tr><td>EnsureStudentExistsAsync</td><td>RetrieveAllStudents + AddStudentAsync</td></tr><tr><td>UpsertStudentAsync</td><td>RetrieveStudentById + AddStudentAsync + ModifyStudentAsync</td></tr><tr><td>VerifyStudentExists</td><td>RetrieveAllStudents</td></tr><tr><td>TryRemoveStudentAsync</td><td>RetrieveStudentById + RemoveStudentByIdAsync</td></tr></tbody></table><p>As you can see, the combination of primitive functions processing services do might also include adding an additional layer of logic on top of the existing primitive operation. For instance, <code>VerifyStudentExists</code> takes advantage of the <code>RetrieveAllStudents</code> primitive function, and then adds a boolean logic to verify the returned student by and Id from a query actually exists or not before returning a <code>boolean</code>.</p><h4 class="anchor anchorWithStickyNavbar_LWe7" id="22201-pass-through">2.2.2.0.1 Pass-Through<a class="hash-link" href="#22201-pass-through" title="Direct link to heading">​</a></h4><p>Processing services may borrow some of the terminology a foundation service may use. for instance, in a pass-through scenario, a processing service with be as simple as <code>AddStudentAsync</code>. We will discuss the architecture-balancing scenarios later in this chapter.
Unlike Foundation services, Processing services are required to have the identifier <code>Processing</code> in their names. for instance, we say <code>StudentProcessingService</code>.</p><h4 class="anchor anchorWithStickyNavbar_LWe7" id="22202-class-level-language">2.2.2.0.2 Class-Level Language<a class="hash-link" href="#22202-class-level-language" title="Direct link to heading">​</a></h4><p>More importantly Processing services must include the name of the entity that is supported by their corresponding Foundation service.
For instance, if a Processing service is dependant on a <code>TeacherService</code>, then the Processing service name must be <code>TeacherProcessingService</code>.</p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="2221-dependencies">2.2.2.1 Dependencies<a class="hash-link" href="#2221-dependencies" title="Direct link to heading">​</a></h3><p>Processing services can only have two types of dependencies. a corresponding Foundation service, or a Utility broker. That&#x27;s simply because Processing services are nothing but an extra higher-order level of business logic, orchestrated by combined primitive operations on the Foundation level.
Processing services can also use Utility brokers such as <code>TimeBroker</code> or <code>LoggingBroker</code> to support it&#x27;s reporting aspect. but it shall never interact with an Entity or Business broker.</p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="2222-one-foundation">2.2.2.2 One-Foundation<a class="hash-link" href="#2222-one-foundation" title="Direct link to heading">​</a></h3><p>Processing services can interact with one and only one Foundation service. In fact without a foundation service there can never be a Processing layer. and just like we mentioned above about the language and naming, Processing services take on the exact same entity name as their Foundation dependency.
For instance, a processing service that handles higher-order business-logic for students will communicate with nothing but its foundation layer, which would be <code>StudentService</code> for instance. That means that processing services will have one and only one service as a dependency in its construction or initiation as follows:</p><div class="language-csharp codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-csharp codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">public class StudentProcessingService</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">{</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    private readonly IStudentService studentService;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    public StudentProcessingService(IStudentService studentService) =&gt;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        this.studentService = studentService;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>However, processing services may require dependencies on multiple utility brokers such as <code>DateTimeBroker</code> or <code>LoggingBroker</code> ... etc.</p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="2223-used-data-only-validations">2.2.2.3 Used-Data-Only Validations<a class="hash-link" href="#2223-used-data-only-validations" title="Direct link to heading">​</a></h3><p>Unlike the Foundation layer services, Processing services only validate what it needs from it&#x27;s input. For instance, if a Processing service is required to validate a student entity exists, and it&#x27;s input model just happens to be an entire <code>Student</code> entity, it will only validate that the entity is not <code>null</code> and that the <code>Id</code> of that entity is valid. the rest of the entity is out of the concern of the Processing service.
Processing services delegate full validations to the layer of services that is concerned with that which is the Foundation layer. here&#x27;s an example:</p><div class="language-csharp codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-csharp codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">public ValueTask&lt;Student&gt; UpsertStudentAsync(Student student) =&gt;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">TryCatch(async () =&gt;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">{</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    ValidateStudent(student);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    IQueryable&lt;Student&gt; allStudents =</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        this.studentService.RetrieveAllStudents();</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    bool isStudentExists = allStudents.Any(retrievedStudent =&gt;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        retrievedStudent.Id == student.Id);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    return isStudentExsits switch {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        false =&gt; await this.studentService.RegisterStudentAsync(student),</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        _ =&gt; await this.studentService.ModifyStudentAsync(student.Id)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    };</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">});</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>Processing services are also not very concerned about outgoing validations except for what it&#x27;s going to use within the same routine. For instance, if a Processing service is retrieving a model, and it&#x27;s going to use this model to be passed to another primitive-level function on the Foundation layer, the Processing service will be required to validate that the retrieved model is valid depending on which attributes of the model it uses.
For Pass-through scenarios however, processing services will delegate the outgoing validation to the foundation layer.</p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="223-responsibilities">2.2.3 Responsibilities<a class="hash-link" href="#223-responsibilities" title="Direct link to heading">​</a></h2><p>Processing services main responsibility is to provide higher-order business logic. This happens along with the regular signature mapping and various use-only validations which we will discuss in detail in this section.</p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="2230-higher-order-logic">2.2.3.0 Higher-Order Logic<a class="hash-link" href="#2230-higher-order-logic" title="Direct link to heading">​</a></h3><p>Higher-order business logic are functions that are above primitive. For instance, <code>AddStudentAsync</code> function is a primitive function that does one thing and one thing only. But higher-order logic is when we try to provide a function that changes the outcome of a single primitive function like <code>VerifyStudentExists</code> which returns a boolean value instead of the entire object of the <code>Student</code>, or a combination of multiple primitive functions such as <code>EnsureStudentExistsAsync</code> which is a function that will only add a given <code>Student</code> model if and only if the aforementioned object doesn&#x27;t already exist in storage. here&#x27;s some examples:</p><h4 class="anchor anchorWithStickyNavbar_LWe7" id="22300-shifters">2.2.3.0.0 Shifters<a class="hash-link" href="#22300-shifters" title="Direct link to heading">​</a></h4><p>The shifter pattern in a higher order business logic is when the outcome of a particular primitive function is changed from one value to another. Ideally a primitive type such as a <code>bool</code> or <code>int</code> not a completely different type as that would violate the purity principle.
For instance, in a shifter pattern, we want to verify if a student exists or not. We don&#x27;t really want the entire object, but just whether it exists in a particular system or not. Now, this seems like a case where we only need to interact with one and only one foundation service and we are shifting the value of the outcome to something else. Which should fit perfectly in the realm of the processing services. Here&#x27;s an example:</p><div class="language-csharp codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-csharp codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">public ValueTask&lt;bool&gt; VerifyStudentExists(Guid studentId) =&gt;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">TryCatch(async () =&gt;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">{</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    IQueryable&lt;Student&gt; allStudents =</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        this.studentService.RetrieveAllStudents();</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    ValidateStudents(allStudents);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    return allStudents.Any(student =&gt; student.Id == studentId);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">});</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>In the snippet above, we provided a higher order business logic, by returning a boolean value of whether a particular student with a given <code>Id</code> exists in the system or not. There are cases where your orchestration layer of services isn&#x27;t really concerned with all the details of a particular entity but just knowing whether it exists or not as a part of an upper business logic or what we call orchestration.</p><p>Here&#x27;s another popular example for processing services shifting pattern:</p><div class="language-csharp codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-csharp codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">public int RetrieveStudentsCount() =&gt;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">TryCatch(() =&gt;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">{</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    IQueryable&lt;Student&gt; allStudents =</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        this.studentService.RetrieveAllStudents();</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    ValidateStudents(allStudents);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    return allStudents.Count();</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">});</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>In the example above, we provided a function to retrieve the count of all students in a given system. It&#x27;s up to the designers of the system to determine whether to interpret a <code>null</code> value retrieved for all students to be an exception case that was not expected to happen or return a <code>0</code>; all depending on how they manage the outcome.
In our case here we validate the outgoing data as much as the incoming, especially if it&#x27;s going to be used within the processing function to ensure further failures do not occur for upstream services.</p><h4 class="anchor anchorWithStickyNavbar_LWe7" id="22301-combinations">2.2.3.0.1 Combinations<a class="hash-link" href="#22301-combinations" title="Direct link to heading">​</a></h4><p>The combination of multiple primitive functions from the foundation layer to achieve a higher-order business logic is one of the main responsibilities of a processing service. As we mentioned before, some of the most popular examples is for ensuring a particular student model exists as follows:</p><div class="language-csharp codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-csharp codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">public async ValueTask&lt;Student&gt; EnsureStudentExistsAsync(Student student) =&gt;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">TryCatch(async () =&gt;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">{</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    ValidateStudent(student);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    IQueryable&lt;Student&gt; allStudents =</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        this.studentService.RetrieveAllStudents();</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    Student maybeStudent = allStudents.FirstOrDefault(retrievedStudent =&gt;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        retrievedStudent.Id == student.Id);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    return maybeStudent switch</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        {} =&gt; maybeStudent,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        _ =&gt; await this.studentService.AddStudentAsync(student)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    };</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">});</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>In the code snippet above, we combined <code>RetrieveAll</code> with <code>AddAsync</code> to achieve a higher-order business logic operation. The <code>EnsureAsync</code> operation which needs to verify something or entity exists first before trying to persist it. The terminology around these higher-order business logic routines is very important. Its importance lies mainly in controlling the expectations of the outcome and the inner functionality. But it also ensures less cognitive resources from the engineers are required to understand the underlying capabilities of a particular routine.
The conventional language used in all of these services also ensures that redundant capability will not be created mistakenly. For instance, an engineering team without any form of standard might create <code>TryAddStudentAsync</code> while already having an existing functionality such as <code>EnsureStudentExistsAsync</code> which does exactly the same thing. The convention here with the limitation of the size of capabilities a particular service may have ensures redundant work shall never occur in any occassion.
There are so many different instances of combinations that can produce a higher-order business logic, for instance we may need to implement a functionality that ensure a student is removed. We use <code>EnsureStudentRemovedByIdAsync</code> to combine a <code>RetrieveById</code> and a <code>RemoveById</code> in the same routine. It all depends on what level of capabilities an upstream service may need to implement such a functionality.</p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="2231-signature-mapping">2.2.3.1 Signature Mapping<a class="hash-link" href="#2231-signature-mapping" title="Direct link to heading">​</a></h3><p>Although processing services operate fully on local models and local contracts, they are still required to map foundation-level services&#x27; models to their own local models. For instance, if a foundation service is throwing <code>StudentValidationException</code> then processing services will map that exception to <code>StudentProcessingDependencyValidationException</code>. Let&#x27;s talk about mapping in this section.</p><h4 class="anchor anchorWithStickyNavbar_LWe7" id="22310-non-exception-local-models">2.2.3.1.0 Non-Exception Local Models<a class="hash-link" href="#22310-non-exception-local-models" title="Direct link to heading">​</a></h4><p>In general, processing services are required to map any incoming or outgoing objects with a specific model to its own. But that rule doesn&#x27;t always apply to non-exception models. For instance, if a <code>StudentProcessingService</code> is operating based on a <code>Student</code> model, and there&#x27;s no need for a special model for this service, then the processing service may be permitted to use the exact same model from the foundation layer.</p><h4 class="anchor anchorWithStickyNavbar_LWe7" id="22311-exception-models">2.2.3.1.1 Exception Models<a class="hash-link" href="#22311-exception-models" title="Direct link to heading">​</a></h4><p>When it comes to processing services handling exceptions from the foundation layer, it is important to understand that exceptions in our Standard are more expressive in their naming conventions and their role more than any other model. Exceptions here define the what, where and why every single time they are thrown.
For instance, an exception that&#x27;s called <code>StudentProcessingServiceException</code> indicates the entity of the exception which is the <code>Student</code> entity. Then it indicates the location of the exception which is the <code>StudentProcessingService</code>. And lastly it indicates the reason for that exception which is <code>ServiceException</code> indicating an internal error to the service that is not a validation or a dependency of nature that happened.
Just like the foundation layer, processing services will do the following mapping to occurring exceptions from its dependencies:</p><table><thead><tr><th>Exception</th><th>Wrap Inner Exception With</th><th>Wrap With</th><th>Log Level</th></tr></thead><tbody><tr><td>StudentDependencyValidationException</td><td>Any inner exception</td><td>StudentProcessingDependencyValidationException</td><td>Error</td></tr><tr><td>StudentValidationException</td><td>Any inner exception</td><td>StudentProcessingDependencyValidationException</td><td>Error</td></tr><tr><td>StudentDependencyException</td><td>-</td><td>StudentProcessingDependencyException</td><td>Error</td></tr><tr><td>StudentServiceException</td><td>_</td><td>StudentProcessingDependencyException</td><td>Error</td></tr><tr><td>Exception</td><td>_</td><td>StudentProcessingServiceException</td><td>Error</td></tr></tbody></table><p>[*][Processing services in Action (Part 1)]<!-- -->(<a href="https://www.youtube.com/watch?v=VgzoZ-b1A4U" target="_blank" rel="noopener noreferrer">https://www.youtube.com/watch?v=VgzoZ-b1A4U</a>)</p><p>[*][Processing services in Action (Part 2)]<!-- -->(<a href="https://www.youtube.com/watch?v=4lfZcWzbIcE" target="_blank" rel="noopener noreferrer">https://www.youtube.com/watch?v=4lfZcWzbIcE</a>)</p><p>[*][Processing services in Action (Part 3)]<!-- -->(<a href="https://www.youtube.com/watch?v=R4sA4V4-_5o" target="_blank" rel="noopener noreferrer">https://www.youtube.com/watch?v=R4sA4V4-_5o</a>)</p><p>[*][Processing services in Action (Part 4)]<!-- -->(<a href="https://www.youtube.com/watch?v=u4uqBiB1TaI" target="_blank" rel="noopener noreferrer">https://www.youtube.com/watch?v=u4uqBiB1TaI</a>)</p></div><footer class="theme-doc-footer docusaurus-mt-lg"><div class="theme-doc-footer-edit-meta-row row"><div class="col"><a href="https://github.com/facebook/docusaurus/tree/main/packages/create-docusaurus/templates/shared/docs/2. Services/2.2 Processings/2.2 Processings.md" target="_blank" rel="noreferrer noopener" class="theme-edit-this-page"><svg fill="currentColor" height="20" width="20" viewBox="0 0 40 40" class="iconEdit_Z9Sw" aria-hidden="true"><g><path d="m34.5 11.7l-3 3.1-6.3-6.3 3.1-3q0.5-0.5 1.2-0.5t1.1 0.5l3.9 3.9q0.5 0.4 0.5 1.1t-0.5 1.2z m-29.5 17.1l18.4-18.5 6.3 6.3-18.4 18.4h-6.3v-6.2z"></path></g></svg>Edit this page</a></div><div class="col lastUpdated_vwxv"></div></div></footer></article><nav class="pagination-nav docusaurus-mt-lg" aria-label="Docs pages navigation"><a class="pagination-nav__link pagination-nav__link--prev" href="/The-Standard/docs/Services/2.1 Foundations/"><div class="pagination-nav__sublabel">Previous</div><div class="pagination-nav__label">2.1 Foundation Services (Broker-Neighboring)</div></a><a class="pagination-nav__link pagination-nav__link--next" href="/The-Standard/docs/Services/2.3 Orchestrations/"><div class="pagination-nav__sublabel">Next</div><div class="pagination-nav__label">2.3 Orchestration Services (Complex Higher Order Logic)</div></a></nav></div></div><div class="col col--3"><div class="tableOfContents_bqdL thin-scrollbar theme-doc-toc-desktop"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#220-introduction" class="table-of-contents__link toc-highlight">2.2.0 Introduction</a></li><li><a href="#221-on-the-map" class="table-of-contents__link toc-highlight">2.2.1 On The Map</a></li><li><a href="#222-charachteristics" class="table-of-contents__link toc-highlight">2.2.2 Charachteristics</a><ul><li><a href="#2220-language" class="table-of-contents__link toc-highlight">2.2.2.0 Language</a></li><li><a href="#2221-dependencies" class="table-of-contents__link toc-highlight">2.2.2.1 Dependencies</a></li><li><a href="#2222-one-foundation" class="table-of-contents__link toc-highlight">2.2.2.2 One-Foundation</a></li><li><a href="#2223-used-data-only-validations" class="table-of-contents__link toc-highlight">2.2.2.3 Used-Data-Only Validations</a></li></ul></li><li><a href="#223-responsibilities" class="table-of-contents__link toc-highlight">2.2.3 Responsibilities</a><ul><li><a href="#2230-higher-order-logic" class="table-of-contents__link toc-highlight">2.2.3.0 Higher-Order Logic</a></li><li><a href="#2231-signature-mapping" class="table-of-contents__link toc-highlight">2.2.3.1 Signature Mapping</a></li></ul></li></ul></div></div></div></div></main></div></div><footer class="footer footer--dark"><div class="container container-fluid"><div class="row footer__links"><div class="col footer__col"><div class="footer__title">Docs</div><ul class="footer__items clean-list"><li class="footer__item"><a class="footer__link-item" href="/The-Standard/docs/intro">Tutorial</a></li></ul></div><div class="col footer__col"><div class="footer__title">Community</div><ul class="footer__items clean-list"><li class="footer__item"><a href="https://stackoverflow.com/questions/tagged/docusaurus" target="_blank" rel="noopener noreferrer" class="footer__link-item">Stack Overflow<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li><li class="footer__item"><a href="https://discordapp.com/invite/docusaurus" target="_blank" rel="noopener noreferrer" class="footer__link-item">Discord<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li><li class="footer__item"><a href="https://twitter.com/docusaurus" target="_blank" rel="noopener noreferrer" class="footer__link-item">Twitter<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li></ul></div><div class="col footer__col"><div class="footer__title">More</div><ul class="footer__items clean-list"><li class="footer__item"><a class="footer__link-item" href="/The-Standard/blog">Blog</a></li><li class="footer__item"><a href="https://github.com/facebook/docusaurus" target="_blank" rel="noopener noreferrer" class="footer__link-item">GitHub<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li></ul></div></div><div class="footer__bottom text--center"><div class="footer__copyright">Copyright © 2022 My Project, Inc. Built with Docusaurus.</div></div></div></footer></div>
<script src="/The-Standard/assets/js/runtime~main.06584d35.js"></script>
<script src="/The-Standard/assets/js/main.1bcd0719.js"></script>
</body>
</html>